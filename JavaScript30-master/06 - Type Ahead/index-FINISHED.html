<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Type Ahead ğŸ‘€</title>
  <link rel="stylesheet" href="style.css"> <!-- å¼•å…¥å¤–éƒ¨CSSæ¨£å¼è¡¨ -->
  <link rel="icon" href="https://fav.farm/âœ…" /> <!-- è¨­ç½®ç¶²é åœ–æ¨™ -->
</head>

<body>

  <form class="search-form">
    <input type="text" class="search" placeholder="City or State"> <!-- è¼¸å…¥æ¡†ï¼Œç”¨æ–¼è¼¸å…¥åŸå¸‚æˆ–å·ä»½åç¨± -->
    <ul class="suggestions">
      <li>Filter for a city</li> <!-- é è¨­æç¤º1 -->
      <li>or a state</li> <!-- é è¨­æç¤º2 -->
    </ul>
  </form>

  <script>
    const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';

    const cities = []; // å„²å­˜åŸå¸‚æ•¸æ“šçš„æ•¸çµ„
    const searchInput = document.querySelector('.search'); // é¸æ“‡è¼¸å…¥æ¡†å…ƒç´ 
    const suggestions = document.querySelector('.suggestions'); // é¸æ“‡æœå°‹å»ºè­°åˆ—è¡¨å…ƒç´ 


    fetch(endpoint)
      .then(blob => blob.json()) // ç™¼èµ·ç¶²çµ¡è«‹æ±‚ä¸¦å°‡å›æ‡‰è½‰æ›æˆ JSON æ ¼å¼
      .then(data => cities.push(...data)); // å°‡åŸå¸‚æ•¸æ“šæ·»åŠ åˆ° cities æ•¸çµ„

    function findMatches(wordToMatch, cities) {
      return cities.filter(place => {
        // 'gi'=>æ­£å‰‡è¡¨é”å¼ä¸­çš„å…¨åŸŸ(æ¨¡ç³Š)åŒ¹é…
        const regex = new RegExp(wordToMatch, 'gi'); // å‰µå»ºæ­£å‰‡è¡¨é”å¼ä»¥é€²è¡Œæ¨¡ç³ŠåŒ¹é…
        return place.city.match(regex) || place.state.match(regex); // åˆ¤æ–·åŸå¸‚æˆ–å·ä»½æ˜¯å¦åŒ¹é…
      });
    }

    function numberWithCommas(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ','); // å°‡æ•¸å­—è½‰æ›æˆåƒä½åˆ†éš”çš„æ ¼å¼
    }

    function displayMatches() {
      const matchArray = findMatches(this.value, cities); // æ‰¾åˆ°åŒ¹é…çš„åŸå¸‚æˆ–å·ä»½
      const html = matchArray.map(place => {
        const regex = new RegExp(this.value, 'gi'); // å‰µå»ºæ­£å‰‡è¡¨é”å¼ä»¥é€²è¡Œé«˜äº®é¡¯ç¤º
        const cityName = place.city.replace(regex, `<span class="hl">${this.value}</span>`); // å°‡åŒ¹é…éƒ¨åˆ†ç”¨ <span> é€²è¡Œé«˜äº®
        const stateName = place.state.replace(regex, `<span class="hl">${this.value}</span>`); // å°‡åŒ¹é…éƒ¨åˆ†ç”¨ <span> é€²è¡Œé«˜äº®
        return `
      <li>
        <span class="name">${cityName}, ${stateName}</span> <!-- é¡¯ç¤ºåŸå¸‚å’Œå·ä»½åç¨± -->
        <span class="population">${numberWithCommas(place.population)}</span> <!-- é¡¯ç¤ºäººå£æ•¸ï¼Œä¸¦é€²è¡Œåƒä½åˆ†éš” -->
      </li>
    `;
      }).join(''); // å°‡ç”Ÿæˆçš„HTMLçµæ§‹åˆä½µæˆä¸€å€‹å­—ç¬¦ä¸²
      suggestions.innerHTML = html; // å°‡HTMLçµæ§‹æ’å…¥åˆ°æœå°‹å»ºè­°åˆ—è¡¨ä¸­
    }


    searchInput.addEventListener('change', displayMatches); // ç›£è½è¼¸å…¥æ¡†çš„è®ŠåŒ–ï¼ŒåŸ·è¡Œ displayMatches å‡½æ•¸
    searchInput.addEventListener('keyup', displayMatches); // ç›£è½éµç›¤æŒ‰éµçš„æ”¾é–‹ï¼ŒåŸ·è¡Œ displayMatches å‡½æ•¸

  </script>
</body>

</html>